<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Panel del Director - BuzÃ³n de Quejas</title>
  <link rel="stylesheet" href="estilos/admin.css">
</head>
<body>
  <header>
    <img src="imagenes/logo_itsp.png" alt="Instituto TecnolÃ³gico" class="logo-item">
    <h1>Panel del Director</h1>
    <p>Sistema Integral de GestiÃ³n de Quejas Estudiantiles</p>
  </header>

  <main>
    <!-- Dashboard de MÃ©tricas -->
    <section class="dashboard">
      <h2>ğŸ“Š  Vista General</h2>
      <div class="metrics-grid">
        <div class="metric-card total">
          <div class="metric-icon">ğŸ“ˆ</div>
          <div class="metric-info">
            <h3 id="totalQuejas">0</h3>
            <p>Total Quejas</p>
            <small id="cambioMensual">+0% este mes</small>
          </div>
        </div>

        <div class="metric-card students">
          <div class="metric-icon">ğŸ‘¥</div>
          <div class="metric-info">
            <h3 id="totalEstudiantes">0</h3>
            <p>Estudiantes</p>
            <small id="estudiantesActivos">con quejas activas</small>
          </div>
        </div>

        <div class="metric-card pending">
          <div class="metric-icon">â³</div>
          <div class="metric-info">
            <h3 id="quejasPendientes">0</h3>
            <p>Pendientes</p>
            <small id="tiempoPromedio">Tiempo prom: 2.5 dÃ­as</small>
          </div>
        </div>

        <div class="metric-card priority">
          <div class="metric-icon">ğŸš¨</div>
          <div class="metric-info">
            <h3 id="quejasUrgentes">0</h3>
            <p>Urgentes</p>
            <small id="requierenAtencion">requieren atenciÃ³n</small>
          </div>
        </div>

        <div class="metric-card career">
          <div class="metric-icon">ğŸ†</div>
          <div class="metric-info">
            <h3 id="carreraMasQuejas">ING. SIS.</h3>
            <p>MÃ¡s Quejas</p>
            <small id="porcentajeCarrera">35% del total</small>
          </div>
        </div>

        <div class="metric-card resolution">
          <div class="metric-icon">âœ…</div>
          <div class="metric-info">
            <h3 id="tasaResolucion">85%</h3>
            <p>Tasa ResoluciÃ³n</p>
            <small id="metaMensual">Meta: 90%</small>
          </div>
        </div>
      </div>
    </section>

    <!-- GrÃ¡ficos -->
    <section class="charts-section">
      <div class="chart-container">
        <div class="chart-card">
          <h3>ğŸ“Š Quejas por Carrera</h3>
          <canvas id="chartCarreras" width="400" height="200"></canvas>
        </div>
        <div class="chart-card">
          <h3>ğŸ“ˆ Tendencia Mensual</h3>
          <canvas id="chartTendencia" width="400" height="200"></canvas>
        </div>
      </div>
    </section>

    <!-- Filtros Avanzados -->
    <section class="filters-advanced">
      <h2>ğŸ” Filtrar </h2>
      <div class="filters-grid">
        <div class="filter-group">
          <label>ğŸ“š Carrera</label>
          <select id="filtroCarrera">
            <option value="">Todas las carreras</option>
          </select>
        </div>

        <div class="filter-group">
          <label>ğŸ“– Semestre</label>
          <select id="filtroSemestre">
            <option value="">Todos los semestres</option>
          </select>
        </div>

        <div class="filter-group">
          <label>ğŸ“… Fecha</label>
          <select id="filtroFecha">
            <option value="">Todo el perÃ­odo</option>
            <option value="hoy">Hoy</option>
            <option value="semana">Esta semana</option>
            <option value="mes">Este mes</option>
            <option value="trimestre">Este trimestre</option>
          </select>
        </div>

        <div class="filter-group">
          <label>ğŸ·ï¸ Estado</label>
          <select id="filtroEstado">
            <option value="">Todos los estados</option>
            <option value="nuevo">ğŸ”´ Nuevo</option>
            <option value="revision">ğŸŸ¡ En RevisiÃ³n</option>
            <option value="respondido">ğŸŸ¢ Respondido</option>
            <option value="cerrado">âš« Cerrado</option>
          </select>
        </div>

        <div class="filter-group">
          <label>â­ Prioridad</label>
          <select id="filtroPrioridad">
            <option value="">Todas las prioridades</option>
            <option value="alta">ğŸ”´ Alta</option>
            <option value="media">ğŸŸ¡ Media</option>
            <option value="baja">ğŸŸ¢ Baja</option>
          </select>
        </div>

        <div class="filter-group">
          <label>ğŸ” BÃºsqueda</label>
          <input type="text" id="busquedaTexto" placeholder="Buscar por nombre, control...">
        </div>

        <div class="filter-actions">
          <button class="btn-filter" onclick="aplicarFiltrosBoton()">ğŸ” Filtrar</button>

          <button class="btn-clear" onclick="limpiarFiltros()">ğŸ—‘ï¸ Limpiar</button>
          <button class="btn-export" onclick="exportarDatos()">ğŸ“Š Exportar</button>
        </div>
      </div>
    </section>

    <!-- Tabla Mejorada -->
    <section class="table-section">
      <div class="table-header">
        <h2>ğŸ“‹ GestiÃ³n de Quejas</h2>
        <div class="table-actions">
          <span id="resultadosCount">0 resultados</span>
          <button class="btn-refresh" onclick="cargarQuejas()" title="Actualizar">ğŸ”„</button>
        </div>
      </div>
      <div id="tablaQuejas" class="tabla"></div>
    </section>

    <!-- Modal de Detalles Mejorado -->
    <div id="detalles" class="detalles-modal"></div>

    <!-- Modal de Templates -->
    <div id="templatesModal" class="templates-modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3>ğŸ“§ Templates de Respuesta</h3>
          <button class="btn-close" onclick="cerrarTemplates()">Ã—</button>
        </div>
        <div class="templates-grid">
          <div class="template-item" onclick="usarTemplate('agradecimiento')">
            <h4>âœ… Agradecimiento</h4>
            <p>Para agradecer y confirmar recepciÃ³n</p>
          </div>
          <div class="template-item" onclick="usarTemplate('investigacion')">
            <h4>ğŸ” En InvestigaciÃ³n</h4>
            <p>Cuando se estÃ¡ investigando el caso</p>
          </div>
          <div class="template-item" onclick="usarTemplate('solucion')">
            <h4>ğŸ¯ SoluciÃ³n Propuesta</h4>
            <p>Para proponer una soluciÃ³n</p>
          </div>
          <div class="template-item" onclick="usarTemplate('derivacion')">
            <h4>â†—ï¸ DerivaciÃ³n</h4>
            <p>Para derivar a otra Ã¡rea</p>
          </div>
          <div class="template-item" onclick="usarTemplate('seguimiento')">
            <h4>ğŸ“‹ Seguimiento</h4>
            <p>Para dar seguimiento al caso</p>
          </div>
          <div class="template-item" onclick="usarTemplate('cierre')">
            <h4>âœ… Cierre de Caso</h4>
            <p>Para cerrar la queja resuelta</p>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- Container para Toast Notifications -->
  <div id="toastContainer" class="toast-container"></div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="app-js/admin.js"></script>
</body>
</html>